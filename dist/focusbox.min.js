(function(e,t,n,r){var i,s,o,u,a,f,l,c,h,p;i='<div class="focusbox">\n	<a class="close"></a>\n	<div class="content">\n		<!-- focusbox content is placed here -->\n	</div>\n</div>',s=function(n){function i(t,i){this.settings=e.extend({},r,i),this._defaults=r,this._name="Basic",this.parent=t,this.$template=e(n),this.init()}var r={};return e.extend(!0,i.prototype,{init:function(){this.$content=this.$template.find(".content"),this.$close=this.$template.find(".close")},open:function(t){return this.$close.on("click."+this._name,function(t){t.preventDefault(),e.focusbox.close()}),e.focusbox.open(this,t)},render:function(n){this.$content.html(n);var r=this,i,s;return this.$template.css({opacity:0}),t.setTimeout(function(){i=r.$template.outerHeight(),r.$template.stop(!0,!0).css({height:0}).animate({opacity:1},100,function(){s=e(t).height(),i=Math.min(i,s),r.$template.stop(!0,!0).animate({height:i},230,function(){r.$template.css("height","auto")})})},1),this.$template},close:function(){this.$close.off("click."+this._name);var t=this;this.$template.stop(!0,!0).animate({opacity:0},200,function(){e(t).trigger("closed")})},remove:function(){this.$close.off("click."+this._name),this.$template.stop(!0,!0)}}),i}(i),o=function(e){var t=arguments,n={};for(var r=t.length-1;r>=0;r--)n[t[r].name]=t[r];return n}(s),u=function(t){var r=t;return function(){return this.$body=e("body"),this.$overlay=e(n.createElement("div")).attr("id",this.settings.prefix+this.settings.overlayId),this.$overlayBg=e(n.createElement("div")).attr("id",this.settings.prefix+this.settings.overlayBgId),this.themes=r,this}}(o),a=function(){function i(){var e=t.pageXOffset!==r?t.pageXOffset:(n.documentElement||n.body.parentNode||n.body).scrollLeft,i=t.pageYOffset!==r?t.pageYOffset:(n.documentElement||n.body.parentNode||n.body).scrollTop;return{x:parseFloat(e)*-1,y:parseFloat(i)*-1}}function s(t){var r=n.createElement("div");r.id=t;while(n.body.firstChild)r.appendChild(n.body.firstChild);return n.body.appendChild(r),e(r)}function o(e){var t;return this.current=e,t=e.render.apply(e,Array.prototype.slice.call(arguments,1)),this.$overlay.append(t),t}function u(t){var r=this;t.esc&&e(n).on("keyup."+this._name,function(t){t.which===27&&(t.preventDefault(),e(n).off("keyup."+r._name),r.close())}),t.overlay&&this.$overlay.on("click."+this._name,function(){event.target==r.$overlay[0]&&(event.preventDefault(),r.$overlay.off("click."+r._name),r.close())})}return function(n){var r;return this.current?(this.current.close(),r=o.apply(this,arguments),e(this).trigger("switched")):(this.scroll=i(),this.$pageWrap=s(this.settings.prefix+this.settings.pageWrapId),this.$pageWrap.css({left:this.scroll.x,top:this.scroll.y}),this.$body.append(this.$overlay,this.$overlayBg),this.$overlayBg.css({opacity:0}).stop(!0,!0).animate({opacity:.3},180),r=o.apply(this,arguments),t.scrollTo(0,0),u.call(this,this.settings.closeOn),e("html, body").addClass("hasOverlay"),e(this).trigger("opened")),r}}(),f=function(){var r=this.$pageWrap[0],i=this;return e(this.current).one("closed",function(){while(r.firstChild)n.body.appendChild(r.firstChild);t.scrollTo(-i.scroll.x,-i.scroll.y),i.$pageWrap.remove(),i.$overlayBg.stop(!0,!0).animate({opacity:0},160,function(){i.current=null,i.$overlay.add(i.$overlayBg).empty().detach(),e("html, body").removeClass("hasOverlay"),e(i).trigger("closed")})}),this.current.close(),this},l=function(t){return this.settings=e.extend(!0,{},this.settings,t),this.$overlay.attr("id",this.settings.prefix+this.settings.overlayId),this.settings.closeOn.esc||e(n).off("keyup."+this._name),this.settings.closeOn.overlay||this.$overlay.off("click."+this._name),this},c=function(t,n,r,i){function u(t){this.settings=e.extend(!0,{},o,t),this._defaults=o,this._name=s,this.init()}var s="Focusbox",o={prefix:"focusbox_",closeOn:{overlay:!0,esc:!0},pageWrapId:"pageWrap",overlayId:"overlay",overlayBgId:"overlayBg"};return e.extend(u.prototype,{init:t,open:n,close:r,options:i}),u}(u,a,f,l),h=function(t){function n(t,n){return this.element=e(t),this.data=this.element.data("focusbox"),this.eventType=n||"click.focusBox",this.init(),this}e.extend(!0,n.prototype,{init:function(){var t=this;switch(this.data.type){case"ajax":var n=this.data.data;this.theme=new e.focusbox.themes.Basic,this.element.on(this.eventType,function(r){r.preventDefault(),e.ajax({url:n.url,data:n.data,type:n.type,success:function(e){t.theme.open(e)}})});return;case"selector":this.content=e(this.data.data).html(),this.theme=new e.focusbox.themes.Basic;break;case"html":this.content=this.data.data,this.theme=new e.focusbox.themes.Basic}this.element.on(this.eventType,function(e){e.preventDefault(),t.theme.open(t.content)})},unbind:function(){this.element.off(this.eventType)}}),e.fn.focusbox=function(t){return arguments[0]=="unbind"?this.each(function(){e.data(this,"plugin_focusbox")&&e.data(this,"plugin_focusbox").unbind()}):this.each(function(){e.data(this,"plugin_focusbox")||e.data(this,"plugin_focusbox",new n(this,t))})}}(c),function(t){e.focusbox=new t,e("[data-focusbox]").focusbox()}(c),p=r})(jQuery,window,document);